# Exome N-of-1 and Tumour-Normal Analysis
## Call SNV and CNA from exome data
### How to Run
#### Reference Generation
The NextFlow pipelines require references (fasta, indexes, etc.) to run. With dependencies NextFlow and Singularity installed, these can be generated by:
```
git clone https://github.com/brucemoran/DNAseq_references
cd DNAseq_references
nextflow run DNAseq_references.GRCh37.simg.nf \
  --exomebed "/local/full/path/to/exome.bed" \
  --cosmicCGCtsv "/local/full/path/to/COSMIC_Census.tsv" \
  -c DNAseq_references.GRCh37.simg.nextflow.config
```

#### Main pipelines
##### Exome N-of-1
To then run exome_n-of-1 pipeline:
```
nextflow run exome_n-of-1.simg.nf \
  --sampleCsv "sample.csv" \
  --refDir "DNAseq_references/GRCh37" \
  --includeOrder "tumour_A,tumour_B"
```
sample.csv has format:
```
type,sampleID,read1,read2
germline,germ1,/full/path/to/germ1.R1.fastq.gz,/full/path/to/germ1.R2.fastq.gz
somatic,soma1,/full/path/to/soma1.R1.fastq.gz,/full/path/to/soma1.R2.fastq.gz
```
N.B that header must match exactly above, and you must have only one germline/normal sample, please give type as 'germline' for the sake of it being correctly identified! Call 'somatic' whatever you like, and input as many of them as you like=D

##### Batch Exome Tumour-Normal
Similarly:
```
nextflow run batch_exome_tumour-normal.simg.nf \
  --sampleCsv "sample.csv" \
  --refDir "DNAseq_references/GRCh37"
```
And again, the input sample.csv file has specific header, input requirements:
```
caseID,soma_sampleID,soma_read1,soma_read2,germ_sampleID,germ_read1,germ_read2
case1,soma1,/path/to/soma1.R1.fastq.gz,/path/to/soma1.R2.fastq.gz,germ1,/path/to/germ1.R1.fastq.gz,/path/to/germ1.R2.fastq.gz
case2,soma2,/path/to/soma2.R1.fastq.gz,/path/to/soma2.R2.fastq.gz,germ2,/path/to/germ2.R1.fastq.gz,/path/to/germ2.R2.fastq.gz
```
